<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Modelle für Vorhersage optimieren • plausi</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Modelle für Vorhersage optimieren">
<meta name="theme-color" content="#293c55">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-7425245790017381",
          enable_page_level_ads: true
     });
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">plausi</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0.9999</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/hochrechnung.html">hochrechnung</a></li>
    <li><a class="dropdown-item" href="../articles/jaanteile.html">Ja-Anteile plausibilisieren</a></li>
    <li><a class="dropdown-item" href="../articles/model_selection.html">Modelle für Vorhersage optimieren</a></li>
    <li><a class="dropdown-item" href="../articles/stimmbeteiligung.html">Auffällige Stimmbeteiligungswerte identifizieren</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Modelle für Vorhersage optimieren</h1>
            
      

      <div class="hidden name"><code>model_selection.Rmd</code></div>

    </div>

    
    
<!-- __WORK IN PROGRESS__ -->
<!-- ```{r, include = FALSE} -->
<!-- knitr::opts_chunk$set( -->
<!--   collapse = TRUE, -->
<!--    comment = "#>", -->
<!--    message = FALSE, -->
<!--    warning= FALSE -->
<!--  ) -->
<!-- ``` -->
<!-- ```{r setup} -->
<!-- library(plausi) -->
<!-- library(caret) -->
<!-- library(tidyverse) -->
<!-- ``` -->
<!-- # Parameter-Tuning mit dem Caret package -->
<!-- ```{r} -->
<!-- # BFS Nummern ausgewählter Gemeinden -->
<!-- bfs_nrs <- c(6,7,10,11,12,87,219,294 ,181,38,60,92,119,182,218) -->
<!-- Sys.setenv(https_proxy="") -->
<!-- # Beziehe historische Daten -->
<!-- results <- swissdd::get_nationalvotes(from_date="2015-03-01", to_date="2020-11-29") -->
<!-- # Formattiere historische Daten um : eine Spalte je Vorlage -->
<!-- testdata <- results %>% -->
<!--   filter(canton_id==1) %>%  -->
<!--   mutate(id=paste0("v",id)) %>% -->
<!--   dplyr::select(jaStimmenInProzent, id, mun_id, mun_name) %>% -->
<!--   pivot_wider(names_from=id, values_from = jaStimmenInProzent) %>%  -->
<!--   drop_na() -->
<!-- traind <- testdata %>%  -->
<!--   mutate_at(vars(v6360),# vars(v6360,v6370), -->
<!--             ~ifelse(mun_id %in% bfs_nrs,., NA)) %>%  -->
<!--   drop_na() -->
<!-- svmGrid <- expand.grid(sigma= 2^c(-25, -20, -15,-10, -5, 0), C= 2^c(0:5)) -->
<!-- svm_mod <- train( -->
<!--   v6360 ~ .,  -->
<!--   data = traind %>% dplyr::select(-mun_id,-mun_name), -->
<!--   method = "svmRadial",                -->
<!--   trControl = trainControl(method = "cv", number = 10), -->
<!--   tuneGrid = svmGrid, -->
<!--   tuneLength = 10 -->
<!-- ) -->
<!-- svm_mod -->
<!-- svm_mod$results -->
<!-- ggplot(svm_mod) +  -->
<!--   theme_light() -->
<!-- testdata$newpred <- predict(svm_mod, testdata) -->
<!-- testdata %>% select(mun_id,mun_name, v6360,newpred) -->
<!-- ``` -->
<!-- # Paramter-Tuning mit dem plausi-package -->
<!-- Das Tuning-Grid kann den Funktionen des plausi-packages ebenfalls übergeben werden. -->
<!-- ```{r} -->
<!-- # works -->
<!-- predict_single_vote("v6360", -->
<!--                     traindata=traind,  -->
<!--                     testdata=testdata, -->
<!--                     method="svmRadial", -->
<!--                     geovars=c("mun_id","mun_name" ), -->
<!--                     tuneGrid=svmGrid, -->
<!--                     tuneLength = 10) -->
<!-- # working - dots are now passed as intended -->
<!-- predict_votes(votes=c("v6360"), -->
<!--                     train=traind,  -->
<!--                     test=testdata, -->
<!--                     method="svmRadial", -->
<!--                     geovars=c("mun_id","mun_name"), -->
<!--                     tuneGrid=svmGrid, -->
<!--                     tuneLength = 10) -->
<!-- ``` -->
<!-- # Modelle vergleichen -->
<!-- Plausi baut auf dem caret-package auf und lässt es somit zu, zwischen unzähligen Machine-Learning Algorithmen zu wählen und einfach umzustellen. Dies erleichtert es Modelle hinsichtlich Vorhersagegenauigkeit zu vergleichen. -->
<!-- Das 'gvcEarth' Model, ein MARS-Modell aus dem 'earth' package (Splines) wie auch ein svm-Modell schneiden am besten ab. Doch neben der Vorhersagegenauigkeit sollte das Modell auch möglichst robust gegenüber einzelnen vermeintlich falschen Resultaten sein bzw. diese sollten die Vorhersage für eine Gemeinde nicht zu stark beeinflussen. -->
<!-- - gcvEarth offers the best accuracy, however seems to be prone to overfit in case of false results (real example: Rüti with switched yes and no-shares) -->
<!-- - svmRadial is a bit less acurate on average however seems not to be affected by single false results -->
<!-- ```{r define models} -->
<!-- # Modelle die verglichen werden sollen -->
<!-- models <- c("gcvEarth","glmboost","pls","pcr","svmRadial") -->
<!-- # Funktion für Vergleich unterschiedlicher Modelle -->
<!-- test_models <- function(votes, train,test, model,...){ -->
<!-- plausi::predict_votes(votes = votes,  -->
<!--                           train = train, -->
<!--                           test=test, -->
<!--                            method = model, -->
<!--                           exclude_votes = TRUE, -->
<!--               ...) %>%  -->
<!--     dplyr::mutate(mod=model)  -->
<!-- } -->
<!-- #Vergleich anhand der Vorhersage für drei Vorlagen -->
<!-- comparison <- map_dfr(models, ~test_models(votes=colnames(train)[c(-1,-2)][1:3], -->
<!--                                         train=train, -->
<!--                                         test=testdata, -->
<!--                                         model=.x, -->
<!--                                         geovars=c("mun_id","mun_name"))) -->
<!-- # Vorhersagefehler je Modell pro Vorlage -->
<!-- comparison %>%  -->
<!--   group_by(vorlage,mod) %>%  -->
<!--   summarize(rmse=RMSE(pred,real,na.rm=TRUE)) -->
<!-- ``` -->
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

      <!-- codefund -->
   <!--<div id="codefund"><!-- fallback content </div> -->
<!--  <script src="https://codefund.app/properties/148/funder.js" async="async"></script>-->
  </div>

</div>



    <footer><div class="copyright">
  <p>Developed by .</p>
</div>

<style>.bmc-button img{width: 27px !important;margin-bottom: 1px !important;box-shadow: none !important;border: none !important;vertical-align: middle !important;}.bmc-button{line-height: 36px !important;height:37px !important;text-decoration: none !important;display:inline-flex !important;color:#000000 !important;background-color:#FFFFFF !important;border-radius: 3px !important;border: 1px solid transparent !important;padding: 0px 9px !important;font-size: 17px !important;letter-spacing:-0.08px !important;box-shadow: 0px 1px 2px rgba(190, 190, 190, 0.5) !important;-webkit-box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;margin: 0 auto !important;font-family:'Lato', sans-serif !important;-webkit-box-sizing: border-box !important;box-sizing: border-box !important;-o-transition: 0.3s all linear !important;-webkit-transition: 0.3s all linear !important;-moz-transition: 0.3s all linear !important;-ms-transition: 0.3s all linear !important;transition: 0.3s all linear !important;}.bmc-button:hover, .bmc-button:active, .bmc-button:focus {-webkit-box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;text-decoration: none !important;box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;opacity: 0.85 !important;color:#000000 !important;}</style>
<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> .</p>
</div>

    </footer>
</div>





  </body>
</html>

<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Modelle für Vorhersage optimieren • plausi</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Modelle für Vorhersage optimieren">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">plausi</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0.9999</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/hochrechnung.html">hochrechnung</a></li>
    <li><a class="dropdown-item" href="../articles/jaanteile.html">Ja-Anteile plausibilisieren</a></li>
    <li><a class="dropdown-item" href="../articles/model_selection.html">Modelle für Vorhersage optimieren</a></li>
    <li><a class="dropdown-item" href="../articles/stimmbeteiligung.html">Auffällige Stimmbeteiligungswerte identifizieren</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Modelle für Vorhersage optimieren</h1>
            
      

      <div class="d-none name"><code>model_selection.Rmd</code></div>
    </div>

    
    
<!-- __WORK IN PROGRESS__ -->
<!-- ```{r, include = FALSE} -->
<!-- knitr::opts_chunk$set( -->
<!--   collapse = TRUE, -->
<!--    comment = "#>", -->
<!--    message = FALSE, -->
<!--    warning= FALSE -->
<!--  ) -->
<!-- ``` -->
<!-- ```{r setup} -->
<!-- library(plausi) -->
<!-- library(caret) -->
<!-- library(tidyverse) -->
<!-- ``` -->
<!-- # Parameter-Tuning mit dem Caret package -->
<!-- ```{r} -->
<!-- # BFS Nummern ausgewählter Gemeinden -->
<!-- bfs_nrs <- c(6,7,10,11,12,87,219,294 ,181,38,60,92,119,182,218) -->
<!-- Sys.setenv(https_proxy="") -->
<!-- # Beziehe historische Daten -->
<!-- results <- swissdd::get_nationalvotes(from_date="2015-03-01", to_date="2020-11-29") -->
<!-- # Formattiere historische Daten um : eine Spalte je Vorlage -->
<!-- testdata <- results %>% -->
<!--   filter(canton_id==1) %>%  -->
<!--   mutate(id=paste0("v",id)) %>% -->
<!--   dplyr::select(jaStimmenInProzent, id, mun_id, mun_name) %>% -->
<!--   pivot_wider(names_from=id, values_from = jaStimmenInProzent) %>%  -->
<!--   drop_na() -->
<!-- traind <- testdata %>%  -->
<!--   mutate_at(vars(v6360),# vars(v6360,v6370), -->
<!--             ~ifelse(mun_id %in% bfs_nrs,., NA)) %>%  -->
<!--   drop_na() -->
<!-- svmGrid <- expand.grid(sigma= 2^c(-25, -20, -15,-10, -5, 0), C= 2^c(0:5)) -->
<!-- svm_mod <- train( -->
<!--   v6360 ~ .,  -->
<!--   data = traind %>% dplyr::select(-mun_id,-mun_name), -->
<!--   method = "svmRadial",                -->
<!--   trControl = trainControl(method = "cv", number = 10), -->
<!--   tuneGrid = svmGrid, -->
<!--   tuneLength = 10 -->
<!-- ) -->
<!-- svm_mod -->
<!-- svm_mod$results -->
<!-- ggplot(svm_mod) +  -->
<!--   theme_light() -->
<!-- testdata$newpred <- predict(svm_mod, testdata) -->
<!-- testdata %>% select(mun_id,mun_name, v6360,newpred) -->
<!-- ``` -->
<!-- # Paramter-Tuning mit dem plausi-package -->
<!-- Das Tuning-Grid kann den Funktionen des plausi-packages ebenfalls übergeben werden. -->
<!-- ```{r} -->
<!-- # works -->
<!-- predict_single_vote("v6360", -->
<!--                     traindata=traind,  -->
<!--                     testdata=testdata, -->
<!--                     method="svmRadial", -->
<!--                     geovars=c("mun_id","mun_name" ), -->
<!--                     tuneGrid=svmGrid, -->
<!--                     tuneLength = 10) -->
<!-- # working - dots are now passed as intended -->
<!-- predict_votes(votes=c("v6360"), -->
<!--                     train=traind,  -->
<!--                     test=testdata, -->
<!--                     method="svmRadial", -->
<!--                     geovars=c("mun_id","mun_name"), -->
<!--                     tuneGrid=svmGrid, -->
<!--                     tuneLength = 10) -->
<!-- ``` -->
<!-- # Modelle vergleichen -->
<!-- Plausi baut auf dem caret-package auf und lässt es somit zu, zwischen unzähligen Machine-Learning Algorithmen zu wählen und einfach umzustellen. Dies erleichtert es Modelle hinsichtlich Vorhersagegenauigkeit zu vergleichen. -->
<!-- Das 'gvcEarth' Model, ein MARS-Modell aus dem 'earth' package (Splines) wie auch ein svm-Modell schneiden am besten ab. Doch neben der Vorhersagegenauigkeit sollte das Modell auch möglichst robust gegenüber einzelnen vermeintlich falschen Resultaten sein bzw. diese sollten die Vorhersage für eine Gemeinde nicht zu stark beeinflussen. -->
<!-- - gcvEarth offers the best accuracy, however seems to be prone to overfit in case of false results (real example: Rüti with switched yes and no-shares) -->
<!-- - svmRadial is a bit less acurate on average however seems not to be affected by single false results -->
<!-- ```{r define models} -->
<!-- # Modelle die verglichen werden sollen -->
<!-- models <- c("gcvEarth","glmboost","pls","pcr","svmRadial") -->
<!-- # Funktion für Vergleich unterschiedlicher Modelle -->
<!-- test_models <- function(votes, train,test, model,...){ -->
<!-- plausi::predict_votes(votes = votes,  -->
<!--                           train = train, -->
<!--                           test=test, -->
<!--                            method = model, -->
<!--                           exclude_votes = TRUE, -->
<!--               ...) %>%  -->
<!--     dplyr::mutate(mod=model)  -->
<!-- } -->
<!-- #Vergleich anhand der Vorhersage für drei Vorlagen -->
<!-- comparison <- map_dfr(models, ~test_models(votes=colnames(train)[c(-1,-2)][1:3], -->
<!--                                         train=train, -->
<!--                                         test=testdata, -->
<!--                                         model=.x, -->
<!--                                         geovars=c("mun_id","mun_name"))) -->
<!-- # Vorhersagefehler je Modell pro Vorlage -->
<!-- comparison %>%  -->
<!--   group_by(vorlage,mod) %>%  -->
<!--   summarize(rmse=RMSE(pred,real,na.rm=TRUE)) -->
<!-- ``` -->
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thomas Lo Russo, Simon Graf.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
